---
import "./ClassicModalPurchaseInfo.css";
import ClassicConfirmPurchaseButton from "../UI/ClassicConfirmPurchaseButton/ClassicConfirmPurchaseButton.astro";
import type { BlockData } from "../../../../../lib/api/types";

const isHaveVariant: string = Astro.props.isHaveVariant;
const purchaseOptions: BlockData = Astro.props.purchaseOptions;

// Determine product option scenarios
const hasVariants = isHaveVariant === "true";
const hasBundles = purchaseOptions !== null;
---

<classic-purchase-modal data-has-variants={hasVariants} data-has-bundles={hasBundles}>
  <div
    data-modal-container
    class="classic-modal fixed inset-0 z-[1000] hidden"
  >
    <div
      data-modal-overlay
      class="classic-modal-overlay absolute inset-0 z-[1001] backdrop-blur-sm"
    >
    </div>
    <div
      class="classic-modal-container relative container md:w-8/12 lg:w-6/12 max-h-[92vh] overflow-y-auto z-[1002] m-4"
    >
      <!-- Purchase Info View (Default) -->
      <div data-modal-purchase-info-view class="modal-view w-full">
        <!-- Enhanced Header -->
        <div class="classic-modal-header flex justify-between items-center p-6 border-b">
          <div class="flex items-center gap-3">
            <div class="w-2 h-8 rounded-full bg-gradient-to-b from-blue-500 to-purple-600"></div>
            <h3
              class="classic-modal-title text-2xl font-bold m-0 bg-gradient-to-r from-gray-800 to-gray-600 bg-clip-text text-transparent"
              data-translate="modal.purchaseInfo"
            >
              ุชุฃููุฏ ุงูุทูุจ
            </h3>
          </div>
          <div class="flex items-center gap-2 text-sm text-gray-500">
            <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
            <span>ุขูู ููุดูุฑ</span>
          </div>
        </div>

        <div class="classic-modal-body p-6">
          <div class="classic-modal-content flex flex-col gap-8">
            <!-- Enhanced Order Summary Section -->
            <div class="classic-purchase-summary flex flex-col gap-6">
              <div class="flex items-center gap-3 mb-4">
                <div class="p-2 bg-blue-50 rounded-lg">
                  <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                  </svg>
                </div>
                <h4
                  class="classic-summary-title text-xl font-bold text-gray-800"
                  data-translate="modal.orderSummary"
                >
                  ููุฎุต ุงูุทูุจ
                </h4>
              </div>

              <!-- Enhanced Quantity Information -->
              <div
                data-modal-quantity-info
                class="classic-summary-section bg-gradient-to-r from-gray-50 to-blue-50 border border-gray-200 rounded-xl p-6 shadow-sm"
              >
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div class="space-y-4">
                    <div class="classic-summary-item flex justify-between py-3 border-b border-gray-200">
                      <span class="classic-summary-label font-medium text-gray-600">ููุน ุงูุทูุจ:</span>
                      <span class="classic-summary-value font-bold text-gray-900" data-modal-order-title>-</span>
                    </div>
                    <div class="classic-summary-item flex justify-between py-3 border-b border-gray-200">
                      <span class="classic-summary-label font-medium text-gray-600">ุนุฏุฏ ุงููุทุน:</span>
                      <span class="classic-summary-value font-bold text-gray-900" data-modal-items-count>-</span>
                    </div>
                  </div>
                  <div class="space-y-4">
                    <div class="classic-summary-item flex justify-between py-3 border-b border-gray-200">
                      <span class="classic-summary-label font-medium text-gray-600">ุณุนุฑ ุงููุทุนุฉ:</span>
                      <span class="classic-summary-value font-bold text-gray-900" data-modal-price-per-item>-</span>
                    </div>
                    <div class="classic-summary-item flex justify-between py-3">
                      <span class="classic-summary-label font-medium text-gray-600">ุงูุฎุตู:</span>
                      <span class="classic-summary-value classic-discount-info font-bold text-green-600" data-modal-discount-info>-</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Enhanced Product Options Section -->
              <!-- Show only when product has variants (scenarios 1 & 2) -->
              {hasVariants && (
                <div
                  data-modal-color-size-info
                  class="classic-summary-section bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6 shadow-sm"
                >
                  <div class="flex items-center gap-3 mb-4">
                    <div class="p-2 bg-purple-100 rounded-lg">
                      <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"></path>
                      </svg>
                    </div>
                    <h5 class="classic-subsection-title text-lg font-bold text-gray-800">
                      {hasBundles ? "ุงุฎุชูุงุฑุงุช ุงูุจุงูุฉ" : "ุงุฎุชูุงุฑุงุช ุงูููุชุฌ"}
                    </h5>
                  </div>
                  
                  <div
                    data-modal-selection-items
                    class="classic-selection-items grid gap-3"
                  >
                    <!-- Dynamic content populated by JavaScript -->
                  </div>
                  
                  {!hasBundles && (
                    <div class="mt-4 p-3 bg-blue-50 rounded-lg border-l-4 border-blue-400">
                      <p class="text-sm text-blue-700 font-medium">
                        โจ ุชู ุงุฎุชูุงุฑ ุงูููุงุตูุงุช ุงููุทููุจุฉ ููููุชุฌ
                      </p>
                    </div>
                  )}
                </div>
              )}

              <!-- Bundle Information Section -->
              <!-- Show only when product has bundles (scenario 1) -->
              {hasBundles && (
                <div class="classic-summary-section bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-6 shadow-sm">
                  <div class="flex items-center gap-3 mb-4">
                    <div class="p-2 bg-emerald-100 rounded-lg">
                      <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"></path>
                      </svg>
                    </div>
                    <h5 class="text-lg font-bold text-gray-800">ูุนูููุงุช ุงูุจุงูุฉ</h5>
                  </div>
                  <div class="p-4 bg-white rounded-lg border border-emerald-200">
                    <p class="text-sm text-emerald-700 font-medium">
                      ๐ฆ ุชู ุงุฎุชูุงุฑ ุจุงูุฉ ุชุญุชูู ุนูู ุฎูุงุฑุงุช ูุชุนุฏุฏุฉ ุจุณุนุฑ ูุฎูุถ
                    </p>
                  </div>
                </div>
              )}

              <!-- Simple Product Notice -->
              <!-- Show when no variants and no bundles (scenario 4) -->
              {!hasVariants && !hasBundles && (
                <div class="classic-summary-section bg-gradient-to-r from-gray-50 to-slate-50 border border-gray-200 rounded-xl p-6 shadow-sm">
                  <div class="flex items-center gap-3">
                    <div class="p-2 bg-gray-100 rounded-lg">
                      <svg class="w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                      </svg>
                    </div>
                    <div>
                      <h5 class="text-lg font-bold text-gray-800">ููุชุฌ ุจุณูุท</h5>
                      <p class="text-sm text-gray-600 mt-1">ููุชุฌ ุฌุงูุฒ ููุดุฑุงุก ุงููุจุงุดุฑ</p>
                    </div>
                  </div>
                </div>
              )}

              <!-- Enhanced Customer Information -->
              <div
                data-modal-customer-info
                class="classic-summary-section bg-gradient-to-r from-indigo-50 to-blue-50 border border-indigo-200 rounded-xl p-6 shadow-sm"
              >
                <div class="flex items-center gap-3 mb-6">
                  <div class="p-2 bg-indigo-100 rounded-lg">
                    <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                  </div>
                  <h5 class="classic-subsection-title text-lg font-bold text-gray-800">ุจูุงูุงุช ุงูุนููู</h5>
                </div>
                
                <div class="classic-customer-details grid grid-cols-1 md:grid-cols-2 gap-4">
                  <div class="space-y-4">
                    <div class="classic-summary-item bg-white p-4 rounded-lg border border-indigo-100">
                      <span class="classic-summary-label font-medium text-gray-600 block mb-1">ุงูุงุณู ุงููุงูู:</span>
                      <span class="classic-summary-value font-bold text-gray-900" data-modal-customer-name>-</span>
                    </div>
                    <div class="classic-summary-item bg-white p-4 rounded-lg border border-indigo-100">
                      <span class="classic-summary-label font-medium text-gray-600 block mb-1">ุงููุงุชู:</span>
                      <span class="classic-summary-value font-bold text-gray-900" data-modal-customer-phone>-</span>
                    </div>
                    <div class="classic-summary-item bg-white p-4 rounded-lg border border-indigo-100">
                      <span class="classic-summary-label font-medium text-gray-600 block mb-1">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู:</span>
                      <span class="classic-summary-value font-bold text-gray-900" data-modal-customer-email>-</span>
                    </div>
                  </div>
                  <div class="space-y-4">
                    <div class="classic-summary-item bg-white p-4 rounded-lg border border-indigo-100">
                      <span class="classic-summary-label font-medium text-gray-600 block mb-1">ุงูุนููุงู:</span>
                      <span class="classic-summary-value font-bold text-gray-900" data-modal-customer-address>-</span>
                    </div>
                    <div class="classic-summary-item bg-white p-4 rounded-lg border border-indigo-100">
                      <span class="classic-summary-label font-medium text-gray-600 block mb-1">ุงููุฏููุฉ:</span>
                      <span class="classic-summary-value font-bold text-gray-900" data-modal-customer-city>-</span>
                    </div>
                    <div class="classic-summary-item bg-white p-4 rounded-lg border border-indigo-100">
                      <span class="classic-summary-label font-medium text-gray-600 block mb-1">ุทุฑููุฉ ุงูุฏูุน:</span>
                      <span class="classic-summary-value font-bold text-gray-900" data-modal-payment-method>-</span>
                    </div>
                  </div>
                  
                  <div
                    class="classic-summary-item bg-white p-4 rounded-lg border border-indigo-100 md:col-span-2"
                    data-modal-notes-section
                  >
                    <span class="classic-summary-label font-medium text-gray-600 block mb-1">ููุงุญุธุงุช:</span>
                    <span class="classic-summary-value font-bold text-gray-900" data-modal-customer-notes>-</span>
                  </div>
                </div>
              </div>

              <!-- Enhanced Total Section -->
              <div class="classic-summary-total bg-gradient-to-r from-green-500 to-emerald-600 text-white p-6 rounded-xl shadow-lg border-2 border-green-400">
                <div class="flex justify-between items-center">
                  <div class="flex items-center gap-3">
                    <div class="p-2 bg-white/20 rounded-lg">
                      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                      </svg>
                    </div>
                    <span class="classic-summary-label text-lg font-semibold">ุงููุฌููุน ุงูููุงุฆู:</span>
                  </div>
                  <span class="classic-summary-value text-2xl font-bold" data-modal-final-total>-</span>
                </div>
              </div>
            </div>

            <!-- Enhanced Action Buttons -->
            <div class="classic-modal-actions flex flex-col sm:flex-row gap-4 mt-6">
              <ClassicConfirmPurchaseButton />
              <button
                type="button"
                class="classic-modal-cancel flex-1 py-4 px-6 rounded-xl font-semibold border-2 border-gray-300 text-gray-700 bg-white hover:bg-gray-50 transition-all duration-300 hover:shadow-md hover:border-gray-400"
                data-modal-cancel-button
                data-translate="modal.cancel"
              >
                ุฅูุบุงุก
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Enhanced Celebration View -->
      <div
        data-modal-celebration-view
        class="modal-view classic-celebration-view w-full hidden"
        style="display: none;"
      >
        <div class="classic-modal-header classic-celebration-header bg-gradient-to-r from-green-500 to-emerald-600 text-white p-6 border-b-0 rounded-t-xl">
          <div class="flex items-center justify-center gap-3">
            <div class="p-2 bg-white/20 rounded-lg">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
              </svg>
            </div>
            <h3
              class="classic-modal-title classic-celebration-title text-2xl font-bold m-0"
              data-translate="celebration.orderConfirmed"
            >
              ุชู ุชุฃููุฏ ุงูุทูุจ ุจูุฌุงุญ
            </h3>
          </div>
        </div>

        <div class="classic-modal-body p-6">
          <div class="classic-modal-content classic-celebration-content flex flex-col gap-8 text-center">
            <!-- Enhanced Success Animation -->
            <div class="classic-celebration-animation flex justify-center items-center my-6">
              <div class="classic-success-checkmark w-24 h-24 rounded-full block relative mx-auto shadow-lg">
                <div class="classic-check-icon w-20 h-20 absolute left-2 top-2 z-10 rounded-full">
                </div>
              </div>
            </div>

            <!-- Enhanced Thank You Message -->
            <div class="classic-celebration-message my-8">
              <h2
                class="classic-celebration-main-title text-4xl font-bold mb-6 bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent"
                data-translate="celebration.thankYou"
              >
                ุดูุฑุงู ูู!
              </h2>
              <p
                class="classic-celebration-subtitle text-lg leading-relaxed max-w-lg mx-auto text-gray-600"
                data-translate="celebration.detailsMessage"
              >
                ุชู ุงุณุชูุงู ุทูุจู ุจูุฌุงุญ ูุณูุชู ุงูุชูุงุตู ูุนู ูุฑูุจุงู ูุชุฃููุฏ ุงูุชูุงุตูู
              </p>
            </div>

            <!-- Enhanced Order Summary -->
            <div class="classic-celebration-summary bg-gradient-to-r from-blue-50 to-indigo-50 p-8 rounded-2xl my-6 border border-blue-200 shadow-sm">
              <div class="space-y-6">
                <div class="classic-celebration-summary-item flex items-center gap-4 p-4 bg-white rounded-xl border border-blue-100">
                  <div class="p-3 bg-blue-100 rounded-xl">
                    <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                    </svg>
                  </div>
                  <div class="classic-celebration-summary-text flex flex-col text-right flex-1">
                    <strong class="font-bold text-gray-800 mb-1">ุฑูู ุงูุทูุจ</strong>
                    <span class="text-sm text-gray-600" data-modal-order-number>#{Math.floor(Math.random() * 100000)}</span>
                  </div>
                </div>
                
                <div class="classic-celebration-summary-item flex items-center gap-4 p-4 bg-white rounded-xl border border-blue-100">
                  <div class="p-3 bg-green-100 rounded-xl">
                    <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                  </div>
                  <div class="classic-celebration-summary-text flex flex-col text-right flex-1">
                    <strong class="font-bold text-gray-800 mb-1">ููุนุฏ ุงูุชุณููู ุงููุชููุน</strong>
                    <span class="text-sm text-gray-600">ุฎูุงู 2-3 ุฃูุงู ุนูู</span>
                  </div>
                </div>
                
                <div class="classic-celebration-summary-item flex items-center gap-4 p-4 bg-white rounded-xl border border-blue-100">
                  <div class="p-3 bg-purple-100 rounded-xl">
                    <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                    </svg>
                  </div>
                  <div class="classic-celebration-summary-text flex flex-col text-right flex-1">
                    <strong class="font-bold text-gray-800 mb-1">ุณูุชู ุงูุชูุงุตู ูุนู</strong>
                    <span class="text-sm text-gray-600">ุฎูุงู ุณุงุนุงุช ููููุฉ ูุชุฃููุฏ ุงูุทูุจ</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Enhanced Actions -->
            <div class="classic-celebration-actions mt-8">
              <button
                type="button"
                class="classic-celebration-primary-button py-4 px-8 rounded-2xl border-none font-bold text-lg cursor-pointer transition-all duration-300 shadow-lg hover:-translate-y-1 hover:shadow-xl bg-gradient-to-r from-blue-600 to-purple-600 text-white"
                data-modal-celebration-continue-button
                data-translate="celebration.continueShopping"
              >
                ููุงุตูุฉ ุงูุชุณูู
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</classic-purchase-modal>

<script>
  import "./ClassicModalPurchaseInfo";
</script>