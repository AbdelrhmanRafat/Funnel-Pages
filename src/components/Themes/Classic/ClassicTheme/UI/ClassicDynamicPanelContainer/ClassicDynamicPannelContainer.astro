---
import type { OptionOption } from "../../../../../../lib/api/types";
import { getTranslation } from "../../../../../../lib/utils/i18n/translations";
import "./ClassicDynamicPannelContainer.css"

const colorSizeOptions: OptionOption[] = Astro.props.colorSizeOptions;
const panelIndex: number = Astro.props["panel-index"] || 1;
const colors: OptionOption | undefined = colorSizeOptions.find(opt => opt.name === 'color');
const sizes: OptionOption | undefined = colorSizeOptions.find(opt => opt.name === 'size');

---

<div id="classic-pannel-container" class="classic-pannel-container" id="panels-container" class="mt-2 space-y-3">
  <div class="option-panel bg-white p-4 rounded-2xl sm:rounded-3xl space-y-4 sm:space-y-8 border border-blue-100">
    <!-- Updated Header with Selection Indicators -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-0">
      <div class="text-blue-700 font-bold text-lg sm:text-xl">
        <p class="inline" data-translate="dynamicPanel.selectOptionsForProduct">
        </p>
        <span data-panel-index={panelIndex}>{panelIndex}</span>
      </div>
      <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto">
        <div class="bg-blue-100 px-3 py-1 rounded-full text-blue-700 text-xs sm:text-sm flex items-center gap-1 justify-center sm:justify-start">
          <span data-translate="dynamicPanel.color">{getTranslation('dynamicPanel.color')}</span>
          <span class="selected-color"></span>
        </div>
        <div class="bg-blue-100 px-3 py-1 rounded-full text-blue-700 text-xs sm:text-sm flex items-center gap-1 justify-center sm:justify-start">
          <span data-translate="dynamicPanel.size">{getTranslation('dynamicPanel.size')}</span>
          <span class="selected-size"></span>
        </div>
      </div>
    </div>
    <div class="py-2 md:py-0 flex flex-col justify-center md:justify-between items-start md:items-start md:flex-row">
      <!-- Size Selection -->
      <div class="select-size-section space-y-2">
        <p class="text-base sm:text-lg font-semibold text-gray-700" data-translate="dynamicPanel.size">{getTranslation('dynamicPanel.size')}</p>
        <div class="grid grid-cols-3 sm:flex gap-2 sm:gap-4">
          {
            Array.isArray(sizes?.value) && sizes.value.map(size => (
              <div
                class="size-option px-3 sm:px-5 py-2 sm:py-2.5 border border-gray-300 rounded-lg sm:rounded-xl cursor-pointer hover:bg-blue-50 hover:text-blue-700 transition-all shadow-sm text-xs sm:text-sm font-medium text-gray-600 text-center"
                data-value={size.value}
              >
                {size.display}
              </div>
            ))
          }
        </div>
      </div>

      <!-- Color Selection -->
      <div class="select-color-section space-y-2">
        <p class="text-base sm:text-lg font-semibold text-gray-700" data-translate="dynamicPanel.color">{getTranslation('dynamicPanel.color')}</p>
        <div class="grid grid-cols-4 sm:flex gap-4 sm:gap-6 justify-items-center">
          {
            Array.isArray(colors?.value) && colors.value.map(color => (
              <div
                class="color-option flex flex-col items-center gap-1 cursor-pointer hover:scale-105 transition-transform"
                data-name={color.name}
              >
                <div
                  class="w-8 h-8 sm:w-9 sm:h-9 rounded-full border-2 border-white shadow-md"
                  style={`background-color: ${color.hex}`}
                ></div>
                <span class="text-xs sm:text-sm text-gray-600 text-center">{color.name}</span>
              </div>
            ))
          }
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  import "./ClassicDynamicPannelContainer";
</script>