---
import type { OptionOption } from "../../../../../../lib/api/types";
import { getTranslation } from "../../../../../../lib/utils/i18n/translations";
import "./ClassicDynamicPannelContainer.css"

const colorSizeOptions: OptionOption[] = Astro.props.colorSizeOptions;
const panelIndex: number = Astro.props["panel-index"] || 1;
const colors: OptionOption | undefined = colorSizeOptions.find(opt => opt.name === 'color');
const sizes: OptionOption | undefined = colorSizeOptions.find(opt => opt.name === 'size');

---
<div id="classic-pannel-container" class="classic-pannel-container" id="panels-container">
  <div class="option-panel classic-option-panel">
    <!-- Updated Header with Selection Indicators -->
    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-0">
      <div class="classic-panel-header">
        <p class="inline" data-translate="dynamicPanel.selectOptionsForProduct">
        </p>
        <span data-panel-index={panelIndex}>{panelIndex}</span>
      </div>
      <div class="flex flex-col sm:flex-row gap-2 w-full sm:w-auto">
        <div class="classic-selection-indicator flex items-center gap-1 justify-center sm:justify-start">
          <span data-translate="dynamicPanel.color">{getTranslation('dynamicPanel.color')}</span>
          <span class="selected-color"></span>
        </div>
        <div class="classic-selection-indicator flex items-center gap-1 justify-center sm:justify-start">
          <span data-translate="dynamicPanel.size">{getTranslation('dynamicPanel.size')}</span>
          <span class="selected-size"></span>
        </div>
      </div>
    </div>
    <div class="py-2 md:py-1 flex flex-col justify-center md:justify-between items-start md:items-start md:flex-row">
      <!-- Size Selection -->
      <div class="select-size-section space-y-2">
        <p class="classic-selection-title" data-translate="dynamicPanel.size">{getTranslation('dynamicPanel.size')}</p>
        <div class="grid grid-cols-3 sm:flex gap-2 sm:gap-4">
          {
            Array.isArray(sizes?.value) && sizes.value.map(size => (
              <div
                class="size-option classic-size-option"
                data-value={size.value}
              >
                {size.display}
              </div>
            ))
          }
        </div>
      </div>

      <!-- Color Selection -->
      <div class="select-color-section space-y-2">
        <p class="classic-selection-title" data-translate="dynamicPanel.color">{getTranslation('dynamicPanel.color')}</p>
        <div class="grid grid-cols-4 sm:flex gap-4 sm:gap-6 justify-items-center">
          {
            Array.isArray(colors?.value) && colors.value.map(color => (
              <div
                class="color-option flex flex-col items-center gap-1 cursor-pointer hover:scale-105 transition-transform"
                data-name={color.name}
              >
                <div
                  class="classic-color-swatch"
                  style={`background-color: ${color.hex}`}
                ></div>
                <span>{color.name}</span>
              </div>
            ))
          }
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  import "./ClassicDynamicPannelContainer";
</script>