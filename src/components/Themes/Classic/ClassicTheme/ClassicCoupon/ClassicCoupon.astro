---
import "./ClassicCoupon.css";
import type { BlockData } from "../../../../../lib/api/types";
import { FunnelClassicComponents } from "../../../../../lib/constants/themes";
import LucideIcon from "../../../../Shared/LucideIcon.astro";

const data: BlockData = Astro.props.data;
const couponName: string | undefined = data.items?.[0].label;
---

<classic-coupon 
    class="w-full"
    data-coupon-value={couponName}
    data-title={data.title}
    data-icon={data.icon}
>
    <section 
        id={FunnelClassicComponents.ClassicCoupon}
        class="classic-section"
        aria-labelledby="coupon-heading"
    >
        <div class="flex flex-col gap-4 md:flex-row md:justify-between md:items-center w-full">
            <!-- Section Header -->
            <header class="classic-section-header md:w-1/2">
                {data.icon && <LucideIcon name={data.icon as any} width="32" height="32" />}
                <h5 id="coupon-heading">{data.title}</h5>
            </header>
            
            <!-- Coupon Container -->
            <div class="flex flex-col sm:flex-row justify-start md:justify-end items-center gap-3 md:w-1/2">
                <div 
                    class="classic-coupon-card px-4 py-3 rounded-lg border-2 border-dashed text-center min-w-0"
                    role="group"
                    aria-labelledby="coupon-heading"
                >
                    <span 
                        class="classic-coupon-code text-lg font-semibold tracking-wide break-all"
                        data-coupon-display
                        aria-label={`Coupon code: ${couponName}`}
                    >
                        {couponName}
                    </span>
                </div>
                
                <button 
                    class="classic-coupon-copy px-4 py-3 flex items-center gap-2 rounded-lg text-sm font-medium transition-all duration-200 min-w-fit"
                    data-coupon-copy-btn
                    type="button"
                    aria-label="Copy coupon code"
                >
                    <div data-copy-icon class="copy-icon-container">
                        <LucideIcon name="Copy" width="32" height="32" class="copy-icon" aria-hidden="true" />
                        <LucideIcon name="Check" width="32" height="32" class="check-icon" aria-hidden="true" style="display: none;" />
                    </div>
                    <span data-copy-text data-translate="coupon.copy"></span>
                </button>
            </div>
        </div>
    </section>
</classic-coupon>

<script>
    import "./ClassicCoupon";
</script>