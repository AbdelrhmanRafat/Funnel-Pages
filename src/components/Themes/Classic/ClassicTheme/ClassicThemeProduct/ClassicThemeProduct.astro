---
// This component displays the main product details page for the Classic theme.
// It includes a gallery, product information (name, price, description), and purchase options.
// Props:
// - product: An object of type Product, containing all details about the product.
// - purchaseOptions: An object of type BlockData, containing data for the purchase options/funnel.

import type {
    BlockData,
    OptionOption,
    Product,
} from "../../../../../lib/api/types";
import GalleryComponent from "../UI/Gallery/GalleryComponent.astro"; // Component for displaying product images.
import ClassicThemeProductFunnel from "../ClassicThemeProductFunnel/ClassicThemeProductFunnel.astro"; // Component for handling purchase options.
import "./ClassicThemeProduct.css"; // Styles specific to this component.
import { getTranslation } from "../../../../../lib/utils/i18n/translations";

// Retrieves product and purchaseOptions from Astro's props.
const product: Product = Astro.props.product;
const purchaseOptions: BlockData = Astro.props.purchaseOptions;
// Extracts color and size options from the product data. Assumes options are structured in a specific way.
const colorSizeOptions: OptionOption[] = product.options[0].options;

// Set language for translations
const lang = "en";

console.log("idnkndlnkdlnld",product);
---

<section class="pt-52">
    <div class="bg-white py-3 rounded-3xl product-shadow">
        <div class="flex flex-col lg:flex-row gap-2 px-4 lg:px-3">
            <!-- Gallery Section -->
            <GalleryComponent product={product} />
            <!-- Product Info Section: -->
            <div
                class="lg:w-1/2 lg:p-3 bg-gradient-to-br from-white to-gray-50"
            >
                <!-- Product Header: Contains availability, SKU, name, price -->
                <div class="mb-8">
                    <div class="flex items-center gap-2 mb-3">
                        <span
                            class="bg-green-100 text-green-800 text-xs px-3 py-1 rounded-full font-medium"
                            >{product.is_active 
                              ? getTranslation('product.available', lang) 
                              : getTranslation('product.notAvailable', lang)}
                            {/* Available / Not Available */}</span
                        >
                        <span class="text-gray-500 text-sm"
                            >{getTranslation('product.productCode', lang)}: {product.sku_code}
                            {/* Product Code: */}</span
                        >
                    </div>

                    <h1
                        class="text-3xl lg:text-4xl font-bold text-gray-900 mb-4 leading-tight"
                    >
                        {product.name_ar}
                        {/* Product Name (Arabic) */}
                    </h1>

                    {
                        /* Static rating display. Could be made dynamic if rating data is available. */
                    }
                    <div class="text-4xl font-bold mb-6">
                        {product.price} ج.م {/* Price in EGP */}
                    </div>
                </div>
                <!-- Product Description -->
                <div class="mb-8">
                    <h3 class="text-xl font-bold text-gray-900 mb-3">
                        {getTranslation('product.description')}
                    </h3>
                    <p
                        class="text-gray-600 leading-relaxed"
                        set:html={product.description_ar}
                    >
                    </p>
                </div>
                <!-- Purchase Options: Renders the product funnel component with purchase and variant options. -->
                <ClassicThemeProductFunnel
                    data={purchaseOptions}
                    colorSizeOptions={colorSizeOptions}
                />
            </div>
        </div>
    </div>
</section>

<script>
    // Imports JavaScript functionalities specific to the ClassicThemeProduct component.
    import "./ClassicThemeProduct";
</script>
