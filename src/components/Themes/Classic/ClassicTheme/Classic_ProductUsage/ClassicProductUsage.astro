---
// server-side code
import "./ClassicProductUsage.css";
import type { BlockData, VideoInfo } from "../../../../../lib/api/types";

const data: BlockData = Astro.props.data;
const productUsage: VideoInfo[] = data.productUsage;

// Helper function to convert watch URL to embed
const getEmbedUrl = (url: string) => {
    const videoIdMatch = url.match(/v=([^&]+)/);
    return videoIdMatch
        ? `https://www.youtube.com/embed/${videoIdMatch[1]}`
        : "";
};
---
<section id="Classic-product-usage" class="classic-section">
    <!-- Header -->
    <div class="classic-section-header">
        <i class="fa-solid fa-circle-chevron-right"></i>
        <h5>شاهد كيفية الاستخدام</h5>
    </div>
    
    <!-- Video Grid -->
    <div class={`grid grid-cols-1 gap-x-2 gap-y-4 md:grid-cols-3`}>
        {
            productUsage.map((video) => (
                <div class="classic-usage-card">
                    <div class="classic-usage-video">
                        <iframe
                            class="classic-usage-iframe"
                            src={getEmbedUrl(video.link)}
                            title={video.title}
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen
                        />
                    </div>
                    <div class="classic-usage-content">
                        <h3 class="classic-usage-title">
                            {video.title}
                        </h3>
                        <p class="classic-usage-subtitle">
                            {video.subtitle}
                        </p>
                    </div>
                </div>
            ))
        }
    </div>
</section>
