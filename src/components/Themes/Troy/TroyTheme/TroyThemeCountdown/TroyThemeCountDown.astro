---
// This component displays a countdown timer for the troy theme.
// It takes hours, minutes, and seconds from the API data and renders a visual timer.
// Props:
// - data: An object of type BlockData, containing the countdown timer values (hours, minutes, seconds).
import "./TroyThemeCountDown.css";
import type { BlockData } from "../../../../../lib/api/types";
import { getTranslation } from "../../../../../lib/utils/i18n/translations";
import { FunnelTroyComponents } from "../../../../../lib/constants/themes";

const data: BlockData = Astro.props.data;
let totalSeconds = 0;

// Calculate the total seconds from the provided hours, minutes, and seconds.
if(data.hours != null && data.minutes != null && data.seconds != null) {
  totalSeconds =
  (parseInt(data.hours?.toString() || '0') || 0) * 3600 +
  (parseInt(data.minutes?.toString() || '0' ) || 0) * 60 +
  (parseInt(data.seconds.toString() || '0' ) || 0);
}
---

<!-- Elegant Countdown Timer with proper spacing for fixed header -->
<section id={FunnelTroyComponents.TroyCountdown} class="troy-section">
  <div class="troy-countdown-container px-6 text-center">
    <div class="troy-middle-title">
    <h2 data-translate="countdown.offerEndsIn">
      {getTranslation('countdown.offerEndsIn')}
    </h2>
    </div>
             
    <countdown-timer
      class="troy-countdown-display flex justify-center gap-4 sm:gap-8 items-center my-7"
      data-total-seconds={totalSeconds}
    >
      {/* Hours display block */}
      <div class="troy-countdown-block rounded-2xl p-5 min-w-20 border-2 flex flex-col justify-center items-center">
        <div class="troy-countdown-number text-4xl font-extrabold" data-countdown-hours>--</div>
        <div class="troy-countdown-label text-sm font-serif" data-translate="countdown.hours">
          {getTranslation('countdown.hours')}
        </div>
      </div>
                   
      {/* Minutes display block */}
      <div class="troy-countdown-block rounded-2xl p-5 min-w-20 border-2 flex flex-col justify-center items-center">
        <div class="troy-countdown-number text-4xl font-extrabold" data-countdown-minutes>--</div>
        <div class="troy-countdown-label text-sm font-serif" data-translate="countdown.minutes">
          {getTranslation('countdown.minutes')}
        </div>
      </div>
                   
      {/* Seconds display block */}
      <div class="troy-countdown-block rounded-2xl p-5 min-w-20 border-2 flex flex-col justify-center items-center">
        <div class="troy-countdown-number text-4xl font-extrabold" data-countdown-seconds>--</div>
        <div class="troy-countdown-label text-sm font-serif" data-translate="countdown.seconds">
          {getTranslation('countdown.seconds')}
        </div>
      </div>
    </countdown-timer>
  </div>
</section>

<script>
       import "./TroyThemeCountDown"
</script>