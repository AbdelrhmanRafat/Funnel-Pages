---
import "./troyThemeHeader.css";
import type { BlockData, Data } from "../../../../../lib/api/types";
import troyLanguageSwitcher from "../UI/troyLanguageSwitcher/troyLanguageSwitcher.astro";
import troyNavigationMenuDesktop from "../troyNavigationMenuDesktop/troyNavigationMenuDesktop.astro";
import troyNavigationMenuMobile from "../troyNavigationMenuMobile/troyNavigationMenuMobile.astro";

const defaultLogoSrc: string = "assets/default-logo.svg";

const data: BlockData = Astro.props.data;
const funnelPage: Data = Astro.props.funnelPage;

const logo = data?.logo || defaultLogoSrc;
const title = data?.title || "";
const subtitle = data?.subtitle || "";
---

<header>
  <div id="troy-header" class="troy-header fixed top-0 left-0 right-0 z-50">
    <div class="w-11/12 md:container mx-auto py-2">
      <!-- Top row with Language Switcher and Menu Button -->
      <div class="flex justify-between items-center mb-2">
        <troyLanguageSwitcher />
        
        <button
          id="header-menu-button"
          class="troy-menu-button p-2 rounded-lg transition-all duration-300 md:hidden"
          aria-label="Open navigation menu"
          type="button"
        >
          <div class="hamburger-icon">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
          </div>
        </button>
      </div>

      <div class="flex flex-col items-center">
        <div class="flex flex-col items-center text-center">
          <img
            id="headerLogo"
            src={logo}
            alt={title || "Logo"}
            class="troy-header-logo w-25 mb-2 object-contain"
          />
          
          <h1 class="troy-header-title text-4xl font-bold leading-tight">
            {title}
          </h1>
          
          <p class="troy-header-subtitle text-sm max-w-80 mt-1" title={subtitle}>
            {subtitle}
          </p>
        </div>
        
        <!-- Enhanced Desktop Navigation with Overflow Handling -->
        <troyNavigationMenuDesktop funnelPage={funnelPage} />
      </div>
    </div>
  </div>

  <!-- Mobile Navigation Menu Overlay - Only visible on mobile -->
  <troyNavigationMenuMobile funnelPage={funnelPage} />
  
  <div class="pt-36 md:pt-60"></div>
</header>

<script>
  // Initialize header functionality
  import "./troyThemeHeader";
</script>