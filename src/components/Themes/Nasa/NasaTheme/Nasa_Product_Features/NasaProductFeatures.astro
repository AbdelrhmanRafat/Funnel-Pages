---
import "./NasaProductFeatures.css"
import type { BlockData, Item } from "../../../../../lib/api/types";
import type { Language } from "../../../../../lib/utils/i18n/translations";
import { FunnelNasaComponents } from "../../../../../lib/constants/themes";
import LucideIcon from "../../../../Shared/LucideIcon.astro";

// Get initial language from cookie during SSR
const currentLang: Language = (Astro.cookies.get("lang")?.value || "en") as Language;
const isArabic = currentLang === "ar";

const data: BlockData = Astro.props.data;
const productFeatures: Item[] = data.items ?? [];
const title = isArabic ? data.title_ar : data.title_en;
---

<section 
  id={FunnelNasaComponents.NasaProductFeatures}
  class="nasa-section"
>
  <!-- Header -->
  <div class="nasa-section-header">
    {data.icon && <LucideIcon name={data.icon as any} width="48" height="48"  />}
    <h5>{title}</h5>
  </div>
    
  <div class="grid grid-cols-2 md:grid-cols-4 gap-8">
    {productFeatures.map((feature, index) => {
      // Define different background colors for each feature using NASA theme
      const backgroundClasses = [
        'nasa-primary-bg',
        'nasa-secondary-bg', 
        'nasa-tertiary-bg',
        'nasa-info-bg'
      ];
      const bgClass = backgroundClasses[index % backgroundClasses.length];
      
      return (
        <div class="flex flex-col items-center gap-3 p-6">
          <!-- Feature Icon with NASA theme colors -->
          <div class={`w-16 h-16 rounded-2xl ${bgClass} flex items-center justify-center nasa-feature-icon-minimal`}>
            {feature.icon ? (
              <LucideIcon name={feature.icon as any} width="32" height="32" class="nasa-feature-icon" />
            ) : (
              <LucideIcon name={data.icon as any} width="32" height="32" class="nasa-feature-icon" />
            )}
          </div>
          
          <!-- Feature Content -->
          <div class="text-center">
            <h3 class="nasa-delivery-title font-bold text-sm leading-tight mb-1">
              {feature.label}
            </h3>
            <p class="nasa-delivery-subtitle text-xs leading-relaxed">
              {feature.content}
            </p>
          </div>
        </div>
      );
    })}
  </div>
</section>