---
// NeonFaq-SplitLayout.astro - Variation 3: Split Layout Design
import "./NeonFaq.css";
import type { BlockData, Faqs, Item } from "../../../../../lib/api/types";
import type { Language } from "../../../../../lib/utils/i18n/translations";
import { FunnelNeonComponents } from "../../../../../lib/constants/themes";
import LucideIcon from "../../../../Shared/LucideIcon.astro";

// Get initial language from cookie during SSR
const currentLang: Language = (Astro.cookies.get("lang")?.value ||
    "ar") as Language;
const isArabic = currentLang === "ar";

const data: BlockData = Astro.props.data;
const faqs: Item[] = data.items ?? [];
---

<!-- FAQ Split Layout Component for Astro -->
<section
    id={FunnelNeonComponents.NeonFaq}
    class="neon-section"
    aria-labelledby="faq-heading"
>
    <!-- Header -->
    <div class="neon-section-header">
        {data.icon && <LucideIcon name={data.icon as any} width="48" height="48" />}
        <h5 id="faq-heading">{isArabic ? data.title_ar : data.title_en}</h5>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Questions List -->
        <div class="space-y-3" data-faq-questions>
            {faqs.map((faq, index) => (
                <div
                    class="neon-faq-splitQuestion p-4 rounded-xl cursor-pointer transition-all duration-300"
                    data-faq-question
                    data-question-index={index}
                    data-answer={faq.content}
                    tabindex="0"
                    role="button"
                    aria-pressed="false"
                >
                    <div class="flex items-center gap-4">
                        <div class="neon-faq-splitNumber w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold">
                            {index + 1}
                        </div>
                        <p class="neon-faq-splitQuestionText font-medium">
                            {faq.label}
                        </p>
                    </div>
                </div>
            ))}
        </div>

        <!-- Answer Display -->
        <div class="neon-faq-splitAnswer rounded-2xl p-8">
            <div data-faq-answer-content>
                <div class="flex items-start gap-4 mb-6">
                    <div class="neon-faq-splitIcon w-12 h-12 rounded-xl flex items-center justify-center">
                        <LucideIcon name="Lightbulb" width="24" height="24" class="neon-faq-splitIconColor" />
                    </div>
                    <div>
                        <span class="neon-faq-splitLabel text-xs uppercase tracking-wide">
                            <span data-translate="faq.answer"></span>
                        </span>
                        <h3 class="neon-faq-splitTitle font-bold text-xl mt-1" data-selected-question>
                            {faqs[0]?.label || ''}
                        </h3>
                    </div>
                </div>
                <p class="neon-faq-splitContent text-base leading-relaxed" data-selected-answer>
                    {faqs[0]?.content || ''}
                </p>
            </div>

            <!-- No Selection Placeholder (hidden by default) -->
            <div data-faq-no-selection class="text-center py-12 hidden">
                <LucideIcon name="Pointer" width="48" height="48" class="neon-faq-splitPlaceholderIcon mx-auto mb-4" />
                <p class="neon-faq-splitPlaceholderText text-lg">
                    <span data-translate="faq.selectQuestion"></span>
                </p>
            </div>
        </div>
    </div>
</section>

<script>
    import "./NeonFaq";
</script>