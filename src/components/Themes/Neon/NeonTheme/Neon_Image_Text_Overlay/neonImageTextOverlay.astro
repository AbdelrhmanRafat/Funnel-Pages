---
import "./neonImageTextOverlay.css";
import type { BlockData, Item } from "../../../../../lib/api/types";
import type { Language } from "../../../../../lib/utils/i18n/translations";
import NeonBuyNowButton from "../UI/NeonBuyNowButton/NeonBuyNowButton.astro";
import { FunnelNeonComponents } from "../../../../../lib/constants/themes";
import LucideIcon from "../../../../Shared/LucideIcon.astro";

// Get initial language from cookie during SSR
const currentLang: Language = (Astro.cookies.get("lang")?.value || "ar") as Language;
const isArabic = currentLang === "ar";

const data: BlockData = Astro.props.data;
const ImageTextData: Item | undefined = data.items?.[0];
---

<section
  id={FunnelNeonComponents.NeonImageTextOverLay}
  class="neon-section py-12 px-4 sm:px-6 lg:px-12"
  aria-labelledby="floating-card-heading"
>
  <!-- Header -->
  <div class="neon-section-header mb-8">
    {data.icon && <LucideIcon name={data.icon as any} width="48" height="48" />}
    <h5>{isArabic ? data.title_ar : data.title_en}</h5>
  </div>

  <!-- Container Query Wrapper -->
  <div class="container-query-wrapper">
<div class="p-0 sm:p-4">
  <div
    class="flex min-h-[480px] flex-col bg-cover bg-center bg-no-repeat sm:rounded-xl px-4 pt-10 sm:px-10 relative overflow-hidden neon-hero-banner"
  >
    <!-- Background Image -->
    {ImageTextData?.image ? (
      <img 
        src={ImageTextData.image}
        alt={ImageTextData.label || 'Product image'}
        class="absolute inset-0 w-full h-full object-cover brightness-75 z-0"
        loading="lazy"
      />
    ) : (
      <div class="absolute inset-0 w-full h-full bg-gradient-to-br opacity-30 z-0"></div>
    )}

    <!-- Gradient Overlay -->
    <div class="neon-hero-overlay"></div>

    <!-- Main Content -->
    <div class="relative z-10 flex flex-col gap-4 flex-1 justify-start">
      <h1 id="floating-card-heading" class="text-4xl font-black neon-hero-title">
        {ImageTextData?.label}
      </h1>
      <h2 class="text-base font-normal neon-hero-subtitle">
        {ImageTextData?.content}
      </h2>
    </div>

    <!-- Button at Bottom -->
    <div class="relative z-10 mt-auto mb-6 w-fit">
      <NeonBuyNowButton />
    </div>
  </div>
</div>
  </div>
</section>
