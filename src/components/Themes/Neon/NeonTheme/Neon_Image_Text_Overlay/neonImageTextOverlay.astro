---
// ProductImageSection.astro
import "./neonImageTextOverlay.css";
import type { BlockData, Item } from "../../../../../lib/api/types";
import type { Language } from "../../../../../lib/utils/i18n/translations";
import NeonBuyNowButton from "../UI/NeonBuyNowButton/NeonBuyNowButton.astro";
import { FunnelNeonComponents } from "../../../../../lib/constants/themes";
import LucideIcon from "../../../../Shared/LucideIcon.astro";

// Get initial language from cookie during SSR
const currentLang: Language = (Astro.cookies.get("lang")?.value || "en") as Language;
const isArabic = currentLang === "ar";

const data: BlockData = Astro.props.data;
const ImageTextData: Item | undefined = data.items?.[0];
---
<section 
  id={FunnelNeonComponents.NeonImageTextOverLay} 
  class="neon-section py-12 px-4 sm:px-6 lg:px-12"
  aria-labelledby="floating-card-heading"
>
  <!-- Header -->
  <div class="neon-section-header mb-8">
    {data.icon && <LucideIcon name={data.icon as any} width="48" height="48" />}
    <h5>{isArabic ? data.title_ar : data.title_en}</h5>
  </div>

  <!-- Floating Banner Container -->
  <div class="relative h-96 sm:h-[500px] rounded-2xl overflow-hidden neon-floating-card-wrapper">
    <!-- Background Image -->
    {ImageTextData?.image ? (
      <img 
        src={ImageTextData.image}
        alt={ImageTextData.label || 'Product image'}
        class="w-full h-full object-cover"
        loading="lazy"
      />
    ) : (
      <div class="w-full h-full bg-gradient-to-br from-gray-400 to-gray-600"></div>
    )}

    <!-- Floating Card -->
    <div class="absolute top-8 right-8 left-8 lg:left-auto lg:w-96">
      <div class="neon-floating-card p-8 rounded-2xl backdrop-blur-lg">
        <h2 
          id="floating-card-heading"
          class="neon-floating-title text-2xl font-bold mb-4"
        >
          {ImageTextData?.label || 'Why this product is the best?'}
        </h2>
        <p class="neon-floating-description text-base leading-relaxed mb-6">
          {ImageTextData?.content || 'This product is specially designed to meet your daily needs with high quality and superior durability.'}
        </p>
        <NeonBuyNowButton />
      </div>
    </div>
  </div>
</section>