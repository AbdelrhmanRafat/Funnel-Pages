---
import "./NeonThemeHeader.css";
import type { BlockData, Data } from "../../../../../lib/api/types";
import NeonLanguageSwitcher from "../UI/NeonLanguageSwitcher/NeonLanguageSwitcher.astro";
import NeonNavigationMenuDesktop from "../NeonNavigationMenuDesktop/NeonNavigationMenuDesktop.astro";
import NeonNavigationMenuMobile from "../NeonNavigationMenuMobile/NeonNavigationMenuMobile.astro";
import type { Language } from "../../../../../lib/utils/i18n/translations";

const data: BlockData = Astro.props.data;
const funnelPage: Data = Astro.props.funnelPage;
// Get initial language from cookie during SSR
const currentLang: Language = (Astro.cookies.get("lang")?.value || "ar") as Language;
const isArabic = currentLang === "ar";

const logo = data?.items?.[0]?.image;
const title = (isArabic ? data?.title_ar : data?.title_en) || "";
const subtitle = data?.items?.[0]?.content || "";
---
<header>
  <div id="neon-header" class="neon-header fixed top-0 left-0 right-0 z-50 transition-transform duration-300 ease-in-out">
<div class="w-11/12 md:container mx-auto py-2">
  <!-- Top Row for Mobile -->
  <div class="flex justify-between items-center mb-4 lg:hidden">
    <NeonLanguageSwitcher />

    <div class="flex flex-col items-center text-center">
      <img
        id="headerLogo"
        src={logo}
        alt={title || 'Logo'}
        class="neon-header-logo w-20 mb-1 object-contain"
      />
      <h1 class="neon-header-title text-xl font-bold leading-tight">{title}</h1>
      <p
        class="neon-header-subtitle text-xs max-w-60 mt-0.5"
        title={subtitle}
      >
        {subtitle}
      </p>
    </div>

    <button
      id="header-menu-button"
      class="neon-menu-button p-2 rounded-lg transition-all duration-300 flex items-center justify-center w-10 h-10"
      aria-label="Open navigation menu"
      type="button"
    >
      <div class="w-5 h-3.5 flex flex-col justify-between">
        <span class="neon-hamburger-line w-full h-0.5 rounded-sm transition-all duration-300"></span>
        <span class="neon-hamburger-line w-full h-0.5 rounded-sm transition-all duration-300"></span>
        <span class="neon-hamburger-line w-full h-0.5 rounded-sm transition-all duration-300"></span>
      </div>
    </button>
  </div>

  <!-- Layout for large screens -->
  <div class="hidden lg:flex justify-between items-center p-4">
    <div class="flex items-center gap-6">
      <img
        id="headerLogo"
        src={logo}
        alt={title || 'Logo'}
        class="neon-header-logo w-24 object-contain"
      />
      <div>
        <h1 class="neon-header-title text-3xl font-bold leading-tight">
          {title}
        </h1>
        <p
          class="neon-header-subtitle text-sm max-w-xs mt-1"
          title={subtitle}
        >
          {subtitle}
        </p>
      </div>
    </div>
      <NeonNavigationMenuDesktop funnelPage={funnelPage} />
      <NeonLanguageSwitcher />
    </div>
  </div>
</div>
  </div>
  <!-- Mobile Navigation Menu Overlay -->
  <NeonNavigationMenuMobile funnelPage={funnelPage} logo={logo} title={title} />
  
  <div class="pt-24 md:pt-24"></div>

</header>

<script>
  import "./NeonThemeHeader";
</script>